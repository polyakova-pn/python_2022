import numpy as np
import matplotlib.pyplot as plt
import matplotlib.ticker as tc
from matplotlib.ticker import LinearLocator
import numpy # импортируем библиотеку
n = 8


fig = plt.figure(figsize=(7, 4))
ax = fig.add_subplot()
ans = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91], [1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91, 1, 11, 21, 31, 41, 51, 61, 71, 81, 91], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [0.239464, 0.9518, 1.35696, 1.556328, 1.681728, 1.771368, 1.83856, 1.891464, 1.933936, 1.96808, 0.885712, 0.239464, 0.152936, 0.166888, 0.236056, 0.332624, 0.445592, 0.55412, 0.65348, 0.742824, 1.118944, 0.366088, 0.239464, 0.181072, 0.151352, 0.151376, 0.17208, 0.205792, 0.24808, 0.297216, 1.26036, 0.46104, 0.31172, 0.239464, 0.196256, 0.167544, 0.151032, 0.14848, 0.157144, 0.173944, 1.361408, 0.537392, 0.371984, 0.2894, 0.239464, 0.205392, 0.180144, 0.162032, 0.150696, 0.148128, 1.438176, 0.601888, 0.423024, 0.334224, 0.278376, 0.239464, 0.211064, 0.189728, 0.17152, 0.158952, 1.503888, 0.656096, 0.468736, 0.373712, 0.312936, 0.271464, 0.239464, 0.215704, 0.195888, 0.179952, 1.55852, 0.705232, 0.509824, 0.408824, 0.345, 0.300056, 0.265992, 0.239464, 0.219144, 0.20136, 1.613408, 0.748296, 0.547168, 0.441168, 0.374576, 0.325976, 0.290248, 0.26216, 0.239464, 0.221184, 1.656288, 0.78752, 0.581104, 0.471536, 0.401592, 0.351288, 0.313544, 0.283368, 0.25976, 0.239464]]


m1 = np.array(ans[0])
m2 = np.array(ans[1])
vol_ = (np.array(ans[3]) / 4 * 3 / np.pi) ** 1 / 3
nu_ = m1 / m2
vol = []
nu = []
for i in range(len(nu_)):
    if nu_[i] > 0.5:
        vol.append(vol_[i])
        nu.append(nu_[i])
vol = np.array(vol)
nu = np.array(nu)

plt.scatter(np.log(nu), vol, color = 'r')
p = np.polyfit(nu, vol, n)

chek_y = []
for i in range(len(nu)):
    chek_y.append(0)
chek_y = np.array(chek_y)

for i in range(n + 1):
    chek_y = chek_y + p[i] * nu ** (n - i)
plt.scatter(np.log(nu), chek_y)

a0 = p[n]
p = np.array(p) / a0
print(p)
plt.grid()
plt.show()